(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(e,i){for(var n=0;n<i.length;n++){var a=i[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,(r=a.key,o=void 0,o=function(e,i){if("object"!==t(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,i||"default");if("object"!==t(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===i?String:Number)(e)}(r,"string"),"symbol"===t(o)?o:String(o)),a)}var r,o}var i=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.elementDOM=e,this.table=!1,this.productDOM=this.elementDOM.parents(ywdpd_qty_args.column_product_info_class),this.qtyDOM=this.productDOM.find(ywdpd_qty_args.product_qty_classes),this.variationForm=this.productDOM.find(ywdpd_qty_args.variation_form_class),this.qtyDOM.on("change",this.handleChangeQuantity.bind(this)),this.initTable(),this.defaultTable=this.elementDOM.html(),this.variationForm&&(this.variationForm.on("show_variation",this.showVariationTable.bind(this)),this.variationForm.on("reset_data",this.resetVariationTable.bind(this)))}var i,n,a;return i=t,n=[{key:"initTable",value:function(){this.table=this.elementDOM.find("#ywdpd-quantity-table"),this.table.on("click","td",this.handleTdClickEvent.bind(this)),this.selectDefaultQty()}},{key:"handleTdClickEvent",value:function(t){t.preventDefault();var e=jQuery(t.target);this.selectRightInfo(e)}},{key:"selectDefaultQty",value:function(){"yes"===ywdpd_qty_args.is_default_qty_enabled&&("yes"===ywdpd_qty_args.show_minimum_price?this.table.find("td.qty-price-info").last():this.table.find("td.qty-price-info").first()).trigger("click")}},{key:"selectRightInfo",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.table.hasClass("vertical")){var i=t.parents("tr");this.toggleRow(i,e)}else{var n=t.index();this.toggleColumn(n,e)}}},{key:"toggleRow",value:function(t,e){this.table.find("td").removeClass("ywdpd_active"),t.find("td").addClass("ywdpd_active");var i=t.find("td.qty-info");e&&this.updateQuantityField(i),this.updatePriceField(i)}},{key:"toggleColumn",value:function(t,e){this.table.find("td").removeClass("ywdpd_active"),this.table.find("tr td:nth-of-type("+t+")").addClass("ywdpd_active");var i=this.table.find("tr td.qty-info:nth-of-type("+t+")");e&&this.updateQuantityField(i),this.updatePriceField(i)}},{key:"handleChangeQuantity",value:function(t){t.stopImmediatePropagation();var e=parseInt(t.target.value);if("yes"===ywdpd_qty_args.is_change_qty_enabled&&e>0){var i=this.table.find("td.qty-info").filter((function(){return"*"!==jQuery(this).data("qtymax")?jQuery(this).data("qtymin")<=e&&jQuery(this).data("qtymax")>=e:jQuery(this).data("qtymin")<=e}));i&&this.selectRightInfo(i,!1)}}},{key:"updateQuantityField",value:function(t){var e="*"===t.data("qtymax")||ywdpd_qty_args.select_minimum_quantity?t.data("qtymin"):t.data("qtymax");this.qtyDOM.val(e)}},{key:"updatePriceField",value:function(t){if("variable"!==this.table.data("product_type")){var e="";e=t.length?t.data("formatted_price"):this.table.data("price_html");var i=t.data("unformatted_price");this.updatePriceHtml(e,i)}}},{key:"updatePriceHtml",value:function(t,e){var i="";if(""!==t){this.productDOM.parents(".yith-quick-view-content").length&&(i=".yith-quick-view-content ");var n=jQuery(i+ywdpd_qty_args.column_product_info_class);n.find(".woocommerce-variation-price").length?n.find(".woocommerce-variation-price .price").html(t):n.find(ywdpd_qty_args.product_price_classes).html(t),jQuery(document).trigger("ywdpd_price_html_updated",[t,e])}}},{key:"showVariationTable",value:function(t,e){if(e.table_price){var i=jQuery(e.table_price);i.find("#ywdpd-quantity-table").length?(this.elementDOM.html(i.html()),this.elementDOM.show(),"yes"!==ywdpd_qty_args.is_default_qty_enabled&&this.updatePriceHtml(e.price_html,"")):(this.elementDOM.html("").hide(),this.updatePriceHtml(e.price_html,"")),this.initTable()}}},{key:"resetVariationTable",value:function(){"yes"===ywdpd_qty_args.show_variable_table?(this.elementDOM.html(this.defaultTable),this.initTable()):this.elementDOM.hide()}}],n&&e(i.prototype,n),a&&e(i,a),Object.defineProperty(i,"prototype",{writable:!1}),t}();function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function a(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,(r=a.key,o=void 0,o=function(t,e){if("object"!==n(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var a=i.call(t,e||"default");if("object"!==n(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r,"string"),"symbol"===n(o)?o:String(o)),a)}var r,o}var r=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.elementDOM=e,this.productNoticeWrapper=e.html(),this.productDOM=this.elementDOM.parents(ywdpd_qty_args.column_product_info_class),this.variationForm=this.productDOM.find(ywdpd_qty_args.variation_form_class),this.variationForm&&(this.variationForm.on("show_variation",this.showVariationNotices.bind(this)),this.variationForm.on("reset_data",this.resetVariationNotices.bind(this)))}var e,i,n;return e=t,(i=[{key:"showVariationNotices",value:function(t,e){if(e.ywdpd_notices){var i=jQuery(e.ywdpd_notices);i.length?this.elementDOM.html(i.html()).show():this.elementDOM.hide()}}},{key:"resetVariationNotices",value:function(){this.elementDOM.html(this.productNoticeWrapper).show()}}])&&a(e.prototype,i),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();jQuery(document).ready((function(t){var e=t(document).find(".ywdpd-table-discounts-wrapper"),n=t(document).find(".ywdpd-notices-wrapper");e.each((function(){new i(t(this))})),n.each((function(){new r(t(this))})),t(document.body).on("payment_method_selected",(function(e){var i=t('.woocommerce-checkout input[name="payment_method"]:checked').attr("id"),n={action:ywdpd_popup_args.actions.valid_rule_in_checkout,security:ywdpd_popup_args.nonces.valid_rule_in_checkout,payment_method:i,context:"frontend"};jQuery.ajax({type:"POST",url:ywdpd_popup_args.ajax_url,data:n,dataType:"json",beforeSend:function(){},success:function(e){t(document.body).trigger("update_checkout")},complete:function(){}})}))}))})();